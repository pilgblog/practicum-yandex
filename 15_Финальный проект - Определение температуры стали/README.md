# Прогнозирование температуры плавления стали
## Цель проекта:
Необходимо построить модель, которая предскажет температуру стали, чтобы уменьшить электропотребление на этапе обработки стали.
## Задача проекта:
Спрогнозировать температуру стали так, чтобы снизить электропотребление, выявить эти составляющие.
## Инструменты:
<div>
  <img src="https://github.com/devicons/devicon/blob/master/icons/python/python-original-wordmark.svg" title="React" alt="React" width="50" height="60"/>&nbsp;
  <img src="https://github.com/devicons/devicon/blob/master/icons/pandas/pandas-original.svg" width="50" height="60"/>&nbsp;
  <img src="https://github.com/scikit-learn/scikit-learn/blob/main/doc/logos/scikit-learn-logo.svg" title="React" alt="React" width="50" height="60"/>&nbsp;
  <img src="https://github.com/mwaskom/seaborn/blob/master/doc/_static/logo-wide-lightbg.svg" title="React" alt="React" width="50" height="60"/>&nbsp;
  <img src="https://github.com/devicons/devicon/blob/master/icons/numpy/numpy-original.svg" title="React" alt="React" width="50" height="60"/>&nbsp;
  <img src="https://github.com/scipy/scipy/blob/main/doc/source/_static/logo.svg" title="React" alt="React" width="50" height="60"/>&nbsp;
</div>

## Вывод:

Перед нами стояла задача регрессии, значение метрики <= 6,8. Целевой признак - последняя температура.

Нам даны семь файлов с данными. На первом этапе мы провели анализ по каждому датасету. Выявили, что в признаках реактивная мощность, температура есть выбросы, которые в следующем этапе мы обработали. По объему сыпучих материалов мы заметили сильную корреляцию между некоторыми bulk, так же мы заметили что всего один ингридиент в bulk 8, на следующем этапе мы решили его удалить. В столбцах bulk мы так же увидели пропуски, которые мы заполинили значением 0, сделав вывод, что подачи этого bulk не было осуществлено. Больше всего значений было в bulk 12. По времени подаче сыпучих материалов мы обнаружили, что некоторые bulk подаются одновременно, пропуски мы заполнили аналогично нулем. В продувке сплава газом мы заметили всплеск от 7 до 10 куб.м. По результатам измерения температуры мы обнаружили пропуски, которые мы в следующем этапе удалили, так же выбросы. В основном температура была сосредоточена в диапазоне от 1575 до 1675 градусов. По объему проволочных материалов нам даны 9 столбцов, больше всего объема было в wire 1, который показывал сильную зависимость с 3 и 4 wire. Так же мы заметили, что wire 5 имеет один ингридиент, поэтому мы удалили его. Мы заполнили пропуски значением 0, как в аналогии с bulk. В данных о времени проволочных материалах, мы так же заметили что добавляется сразу несколько проволочных материалов.

Во втором пункте плана мы удалили выбросы, в том числе температуру ниже 1500 градусов. Создали новый признак - работа, измеряющийся в кВт/сек, по формуле:
P = A * t, где A - активная мощность, а t - время затраченное на нагрев дугой
Далее мы сгруппировали датасеты по партиям, и обнаружили, что в некоторых партиях температура не измерялась, поэтому мы эти партии удалили. Далее создали новый признак время, как разница между начальной и конечной температуры. После того, как были готовы все признаки и сформированные датасеты по партиям, мы объединили данные в одну таблицу и назвали ее data. Сформировав по данным data тепловую карту, мы обнаружили сильные зависимости между bulk 9 и wire 5. Мы решили удалить один из столбцов, bulk 9. Так же в наши новые данные не входила активная и реактивная мощность, в свзяи с этим у нас был признак работа.

В третьем этапе мы выделили целевой признак - последняя температура в каждой партии. Поделили выборку на обучающую и тестовую как 3:1. Для линейной регрессии мы масштабировали признаки.

Для обучения мы использовали следующие модели:
LinearRegression
DecisionTreeRegressor
CatBoostRegressor
LGBMRegressor

Самая низкая метрика MAE показала на модели CatBoostRegressor - 5,75. Для данной модели мы построили график значимости признаков и обнаружили, что самые значимые признаки являлись работа, замер первой температуры в партии, wire 1 и время разницы между первой и последней температуры. Мы проверили модель на тестовой выборке, МАЕ получилось 5,75. Сравнили нашу метрики со стратегией среднего значения DummyRegressor и получили на тестовых данных MAE 8,13. Отсюда сделали вывод, что наша модель приемлема.
Лучшие параметры модели CatBoostRegressor:
param = [{ 'learning_rate': [0.05, 0.1], 'n_estimators': range(100, 500, 100), 'random_state': [100423] }], cv=5

Подбробно расскажем о значимости факторов лучшей модели CatBoostRegressor, чтобы вы могли сравнить наши данные проводя эксперемент для экономии электропотребления. Наша модель выделила самый большой признак работа, которая составляет 25% от общего числа признаков. Она состоит из активной мощности и времени затраченного на нагрев дугой. Первоначальная температура составляет 23%, т.е. эти два фактора имеют наибольшее влияние на предсказание, и являются значимыми. 7,5% составляет признак wire 1, и 7% delta time, т.е. время разницы между начальной и конечной температурой. Если поработать над самыми влияющими признаками, то можно иметь возможность снизить электропотребление на каждом из этапов технологического процесса.

Можно сделать вывод. Для того, чтобы снизить электропотребление на этапе обработки стали, исходя из промежуточных выводов, мы предлагаем подавать на входе температуру выше, работа будет производится меньше, следовательно затраты на электроэнергию уменьшатся. Далее мы советуем убрать из добавок в химический состав bulk 9 или wire 5.
